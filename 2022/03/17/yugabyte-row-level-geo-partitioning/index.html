<!doctype html><html lang=en data-figures class=page><head><title>Yugabyte - Row Level Geo Partitioning | Yogendra Rampuria</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta http-equiv=x-ua-compatible content="IE=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-21164716-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-21164716-2');</script><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta name=description content="Lets have look at one of the most interesting features of YugabyteDB - Row Level Geo-distribution
I have joined Yugabyte a while back. I have gone through many …"><meta name=twitter:card content="summary_large_image"><meta name=twitter:creator content="@yogendra"><meta name=twitter:title content="Yugabyte - Row Level Geo Partitioning"><meta property="og:url" content="https://yogendra.github.io/2022/03/17/yugabyte-row-level-geo-partitioning/"><meta property="og:title" content="Yugabyte - Row Level Geo Partitioning"><meta property="og:description" content="Lets have look at one of the most interesting features of YugabyteDB - Row Level Geo-distribution
I have joined Yugabyte a while back. I have gone through many …"><meta property="og:image" content="https://yogendra.github.io/2022/03/17/yugabyte-row-level-geo-partitioning/00-row-geo-partition.png"><link rel=apple-touch-icon sizes=180x180 href=https://yogendra.github.io/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://yogendra.github.io/icons/favicon-32x32.png><link rel=manifest href=https://yogendra.github.io/icons/site.webmanifest><link rel=canonical href=https://yogendra.github.io/2022/03/17/yugabyte-row-level-geo-partitioning/><link rel=preload href=https://yogendra.github.io/css/styles.3fc8c6564d7cd0de811bba4ee86be8e38adff50121d098db42c53cf51dbe0339acb2cf3b8ab69ab5491feb81bb2196dccd67aaf3e9a483087f6e393d2cc16a0f.css integrity="sha512-P8jGVk180N6BG7pO6Gvo44rf9QEh0JjbQsU89R2+Azmsss87iraatUkf64G7IZbczWeq8+mkgwh/bjk9LMFqDw==" as=style crossorigin=anonymous><link rel=preload href=https://yogendra.github.io/js/bundle.min.da0313a21911386c83a3ac1292945219a043acb97b47a4a9f491890f81a8a94381d0a21a63ae910c05135033e52cac73a1bd5be668d695235a5361f238d4ccb0.js as=script integrity="sha512-2gMTohkROGyDo6wSkpRSGaBDrLl7R6Sp9JGJD4GoqUOB0KIaY66RDAUTUDPlLKxzob1b5mjWlSNaU2HyONTMsA==" crossorigin=anonymous><link rel=stylesheet type=text/css href=https://yogendra.github.io/css/styles.3fc8c6564d7cd0de811bba4ee86be8e38adff50121d098db42c53cf51dbe0339acb2cf3b8ab69ab5491feb81bb2196dccd67aaf3e9a483087f6e393d2cc16a0f.css integrity="sha512-P8jGVk180N6BG7pO6Gvo44rf9QEh0JjbQsU89R2+Azmsss87iraatUkf64G7IZbczWeq8+mkgwh/bjk9LMFqDw==" crossorigin=anonymous></head><body data-code=10 data-lines=true id=documentTop><header class=nav_header><nav class=nav><a href=https://yogendra.github.io class="nav_brand nav_item" title="Yogendra Rampuria"><img src=https://yogendra.github.io/images/logo-64.png class=logo alt="Yogendra Rampuria"><div class=nav_close><div><svg class="icon"><use xlink:href="#open-menu"/></svg><svg class="icon"><use xlink:href="#closeme"/></svg></div></div></a><div class="nav_body nav_body_left"><div class=nav_parent><a href=https://yogendra.github.io class=nav_item title=Home>Home</a></div><div class=nav_parent><a href=https://yogendra.github.io/projects/ class=nav_item title=Projects>Projects</a></div><div class=nav_parent><a href=https://yogendra.github.io/about/ class=nav_item title=About>About</a></div><div class=nav_parent><a href=https://yogendra.github.io/security.html class=nav_item title=Security>Security</a></div><div class=follow><a href=https://github.com/yogendra><svg class="icon"><use xlink:href="#github"/></svg></a><a href=https://twitter.com/yogendra><svg class="icon"><use xlink:href="#twitter"/></svg></a><a href=https://www.linkedin.com/in/yogi><svg class="icon"><use xlink:href="#linkedin"/></svg></a><a href=https://yogendra.github.io/index.xml><svg class="icon"><use xlink:href="#rss"/></svg></a><div class=color_mode><input type=checkbox class=color_choice id=mode></div></div></div></nav></header><main><div class="grid-inverse wrap content"><article class=post_content><h1 class=post_title>Yugabyte - Row Level Geo Partitioning</h1><div class=post_meta><span><svg class="icon"><use xlink:href="#calendar"/></svg></span><span class=post_date>Mar 17, 2022</span>
<span class=post_time>· 27 min read</span><span>&nbsp;· <a href=https://yogendra.github.io/tags/yugabyte title=yugabyte class="post_tag button button_translucent">yugabyte</a></span>
<span class=page_only>&nbsp;·<div class=post_share>Share on:
<a href="https://twitter.com/intent/tweet?text=Yugabyte%20-%20Row%20Level%20Geo%20Partitioning&url=https%3a%2f%2fyogendra.github.io%2f2022%2f03%2f17%2fyugabyte-row-level-geo-partitioning%2f&tw_p=tweetbutton" class=twitter title="Share on Twitter" target=_blank rel=nofollow><svg class="icon"><use xlink:href="#twitter"/></svg></a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fyogendra.github.io%2f2022%2f03%2f17%2fyugabyte-row-level-geo-partitioning%2f&t=Yugabyte%20-%20Row%20Level%20Geo%20Partitioning" class=facebook title="Share on Facebook" target=_blank rel=nofollow><svg class="icon"><use xlink:href="#facebook"/></svg></a><a href=#linkedinshare id=linkedinshare class=linkedin title="Share on LinkedIn" rel=nofollow><svg class="icon"><use xlink:href="#linkedin"/></svg></a><a href=https://yogendra.github.io/2022/03/17/yugabyte-row-level-geo-partitioning/ title="Copy Link" class="link link_yank"><svg class="icon"><use xlink:href="#copy"/></svg></a></div></span></div><div class=post_body><p>Lets have look at one of the most interesting features of YugabyteDB - Row Level Geo-distribution</p><p>I have joined Yugabyte a while back. I have gone through many demos/samples. But one thing that caught my attention very early on was the geo-pinning the data.</p><p>This capability can simplify compliance of data privacy laws, data sovereignty laws, etc. It can make the overall architecture of the application very simple.
Here is my stab at this feature. I followed the documentation for most part. I added only the cluster management parts to the whole guide for a quick self-drive.</p><p>Instead of working with actual cloud, I ran the whole setup on my machine. This will need about 2GB of free RAM. At its peak, there will be 3 master (100MB), 12 tserver(100MB) and 12 postgres (50MB) processes.
I wanted to remove the network out of the picture to understand the data persistance portion of Yugabyte, hence the local machine cluster.<figure><picture>
<img class="image_figure image_internal" src=/2022/03/17/yugabyte-row-level-geo-partitioning/00-row-geo-partition.png alt loading=lazy decoding=async width=1600 height=1130></picture></figure></p><h2 id=pre-requisites>Pre-requisites</h2><p>You will require Yugabyte binaries for your platform. On Macs with Apple Silicon, you should have rosetta</p><ol><li><p><a href=https://download.yugabyte.com/>YugabyteDB binary (Mac/Linux-x86/ Linux-aarch64)</a></p><p><strong>Mac</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -O https://downloads.yugabyte.com/releases/2.13.0.0/yugabyte-2.13.0.0-b42-darwin-x86_64.tar.gz
tar xvfz yugabyte-2.13.0.0-b42-darwin-x86_64.tar.gz
echo <span style=color:#e6db74>&#34;export PATH=</span>$PWD<span style=color:#e6db74>/yugabyte-2.13.0.0/bin:\$PATH&#34;</span> &gt;&gt; $HOME/.bashrc
source $HOME/.bashrc
</code></pre></div><p>On Macs with Apple Silicon, you should have <a href=https://support.apple.com/en-sg/HT211861>Rosetta installed</a>.</p><p><strong>Linux</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>wget https://downloads.yugabyte.com/releases/2.13.0.0/yugabyte-2.13.0.0-b42-linux-x86_64.tar.gz
tar xvfz yugabyte-2.13.0.0-b42-linux-x86_64.tar.gz
echo <span style=color:#e6db74>&#34;export PATH=</span>$PWD<span style=color:#e6db74>/yugabyte-2.13.0.0/bin:\$PATH&#34;</span> &gt;&gt; $HOME/.bashrc
source $HOME/.bashrc
$PWD/yugabyte-2.13.0.0/bin/post_install.sh
</code></pre></div></li><li><p>Additional 12 alias/IPs for loopback interface</p><p><strong>Mac/Linux</strong></p><p>This is an ephemeral setup and will get reset ones you reboot machine. You can re-run the same command to setup interfaces, in case of a reboot.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#66d9ef>for</span> i in <span style=color:#f92672>{</span>1..12<span style=color:#f92672>}</span>
<span style=color:#66d9ef>do</span>
  sudo ifconfig lo0 alias  127.0.0.$i up
<span style=color:#66d9ef>done</span>
</code></pre></div><p>Check the aliases</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash> ifconfig lo0
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log> lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 16384
         options=1203&lt;RXCSUM,TXCSUM,TXSTATUS,SW_TIMESTAMP&gt;
         inet 127.0.0.1 netmask 0xff000000
         inet6 ::1 prefixlen 128
         inet6 fe80::1%lo0 prefixlen 64 scopeid 0x1
         inet 127.0.0.2 netmask 0xff000000
         inet 127.0.0.3 netmask 0xff000000
         inet 127.0.0.4 netmask 0xff000000
         inet 127.0.0.5 netmask 0xff000000
         inet 127.0.0.6 netmask 0xff000000
         inet 127.0.0.7 netmask 0xff000000
         inet 127.0.0.8 netmask 0xff000000
         inet 127.0.0.9 netmask 0xff000000
         inet 127.0.0.10 netmask 0xff000000
         inet 127.0.0.11 netmask 0xff000000
         inet 127.0.0.12 netmask 0xff000000
         nd6 options=201&lt;PERFORMNUD,DAD&gt;
</code></pre></li></ol><h2 id=setup-local-cluster>Setup Local Cluster</h2><ol><li><p>Clean up any existing cluster (in case you are repeating or followed another tutorial).</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yb-ctl destroy --data_dir $PWD/data
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>Destroying cluster.
</code></pre></li><li><p>Create a new cluster. This cluster will have replication factor of 3, and will have nodes spread in 3 regions. 1 node per region. We will use <strong>us-west-2</strong>, <strong>eu-central-1</strong> and <strong>ap-south-1</strong> regions of <strong>aws</strong>. And we will use the <strong>us-west-2a</strong>, <strong>eu-central-1a</strong> and <strong>ap-south-1a</strong> zones, from these regions.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yb-ctl start --data_dir $PWD/data --rf <span style=color:#ae81ff>3</span>  --placement_info <span style=color:#e6db74>&#34;aws.us-west-2.us-west-2a,aws.eu-central-1.eu-central-1a,aws.ap-south-1.ap-south-1a&#34;</span>
</code></pre></div><p><strong>NOTE for Mac:</strong> You will get multiple (6) prompts/dialogs stating <em>yb-tserver</em> or <em>yb-master</em> to accept incoming connections. Allow all of them. This will happen later when we add more nodes. Repeat</p><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>Creating cluster.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node Count: 3 | Replication Factor: 3                                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.1:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh                                               |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh                                               |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli                                            |
| Web UI              : http://127.0.0.1:7000/                                                     |
| Cluster Data        : /tmp/demo/data                                                             |
----------------------------------------------------------------------------------------------------

For more info, please use: yb-ctl --data_dir /tmp/demo/data status
</code></pre></li><li><p>(Optional) Check the current cluster configuration</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yb-ctl status --data_dir $PWD/data
</code></pre></div><pre><code class=language-log data-lang=log>----------------------------------------------------------------------------------------------------
| Node Count: 3 | Replication Factor: 3                                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.1:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh                                               |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh                                               |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli                                            |
| Web UI              : http://127.0.0.1:7000/                                                     |
| Cluster Data        : /tmp/demo/data                                                             |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 1: yb-tserver (pid 90648), yb-master (pid 90639)                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.1:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh                                               |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh                                               |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli                                            |
| data-dir[0]         : /tmp/demo/data/node-1/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-1/disk-1/yb-data/tserver/logs                          |
| yb-master Logs      : /tmp/demo/data/node-1/disk-1/yb-data/master/logs                           |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 2: yb-tserver (pid 90651), yb-master (pid 90642)                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.2:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.2                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.2                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.2                               |
| data-dir[0]         : /tmp/demo/data/node-2/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-2/disk-1/yb-data/tserver/logs                          |
| yb-master Logs      : /tmp/demo/data/node-2/disk-1/yb-data/master/logs                           |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 3: yb-tserver (pid 90654), yb-master (pid 90645)                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.3:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.3                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.3                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.3                               |
| data-dir[0]         : /tmp/demo/data/node-3/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-3/disk-1/yb-data/tserver/logs                          |
| yb-master Logs      : /tmp/demo/data/node-3/disk-1/yb-data/master/logs                           |
----------------------------------------------------------------------------------------------------
</code></pre></li><li><p>(Optional) Launch the <a href=http://127.0.0.1:7000>Master UI</a> in browser for looking at the state of cluster</p><p><figure><picture>
<img class="image_figure image_internal" src=/2022/03/17/yugabyte-row-level-geo-partitioning/01-master-ui.png alt="Master Server" loading=lazy decoding=async width=3592 height=2098></picture></figure></p><ol><li><p>You can examine the cluster config JSON by clicking on <strong>Home > Overview > (See full config)</strong> <a href=http://127.0.0.1:7000/cluster-config>or click here</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>version</span>: <span style=color:#ae81ff>1</span>
<span style=color:#ae81ff>replication_info {</span>
  <span style=color:#ae81ff>live_replicas {</span>
    <span style=color:#f92672>num_replicas</span>: <span style=color:#ae81ff>3</span>
    <span style=color:#ae81ff>placement_blocks {</span>
      <span style=color:#ae81ff>cloud_info {</span>
        <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
        <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;eu-central-1&#34;</span>
        <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;eu-central-1a&#34;</span>
      }
      <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
    }
    <span style=color:#ae81ff>placement_blocks {</span>
      <span style=color:#ae81ff>cloud_info {</span>
        <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
        <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;ap-south-1&#34;</span>
        <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;ap-south-1a&#34;</span>
      }
      <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
    }
    <span style=color:#ae81ff>placement_blocks {</span>
      <span style=color:#ae81ff>cloud_info {</span>
        <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
        <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;us-west-2&#34;</span>
        <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;us-west-2a&#34;</span>
      }
      <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
    }
  }
}
<span style=color:#f92672>cluster_uuid</span>: <span style=color:#e6db74>&#34;a1ae0a02-f004-4cc8-b608-206ec3f7fc8f&#34;</span>
</code></pre></div></li><li><p>You can check TServer details by clicking <strong>Home > Overview > (See all nodes)</strong> <a href=http://127.0.0.1:7000/tablet-servers>or click here</a></p><p><figure><picture>
<img class="image_figure image_internal" src=/2022/03/17/yugabyte-row-level-geo-partitioning/03-tservers.png alt=TServers loading=lazy decoding=async width=1801 height=1049></picture></figure></p></li><li><p>You can check tables by clicking <strong>Home > Overview > (See all tables)</strong> <a href=http://127.0.0.1:7000/tables>or click here</a></p><p><figure><picture>
<img class="image_figure image_internal" src=/2022/03/17/yugabyte-row-level-geo-partitioning/04-tables.png alt=Tables loading=lazy decoding=async width=3600 height=2098></picture></figure></p></li></ol></li><li><p>Back on command prompt, lets add 2 additional nodes for each of the 3 region. So, 6 additional nodes have to be added. This will make total node count to 9. We want to keep each node is a separate zone for intra-region resiliency.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>
yb-ctl --data_dir $PWD/data add_node --placement_info <span style=color:#e6db74>&#34;aws.us-west-2.us-west-2b&#34;</span>
yb-ctl --data_dir $PWD/data add_node --placement_info <span style=color:#e6db74>&#34;aws.us-west-2.us-west-2c&#34;</span>

yb-ctl --data_dir $PWD/data add_node --placement_info <span style=color:#e6db74>&#34;aws.eu-central-1.eu-central-1b&#34;</span>
yb-ctl --data_dir $PWD/data add_node --placement_info <span style=color:#e6db74>&#34;aws.eu-central-1.eu-central-1c&#34;</span>

yb-ctl --data_dir $PWD/data add_node --placement_info <span style=color:#e6db74>&#34;aws.ap-south-1.ap-south-1b&#34;</span>
yb-ctl --data_dir $PWD/data add_node --placement_info <span style=color:#e6db74>&#34;aws.ap-south-1.ap-south-1c&#34;</span>

</code></pre></div><pre><code class=language-log data-lang=log>Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 4: yb-tserver (pid 91265)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.4:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.4                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.4                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.4                               |
| data-dir[0]         : /tmp/demo/data/node-4/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-4/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 5: yb-tserver (pid 91323)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.5:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.5                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.5                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.5                               |
| data-dir[0]         : /tmp/demo/data/node-5/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-5/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 6: yb-tserver (pid 91385)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.6:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.6                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.6                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.6                               |
| data-dir[0]         : /tmp/demo/data/node-6/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-6/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 7: yb-tserver (pid 91449)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.7:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.7                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.7                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.7                               |
| data-dir[0]         : /tmp/demo/data/node-7/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-7/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 8: yb-tserver (pid 91495)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.8:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.8                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.8                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.8                               |
| data-dir[0]         : /tmp/demo/data/node-8/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-8/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 9: yb-tserver (pid 91549)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.9:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.9                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.9                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.9                               |
| data-dir[0]         : /tmp/demo/data/node-9/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-9/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
</code></pre></li><li><p>(Optional) Check the current cluster configuration</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yb-ctl status --data_dir $PWD/data
</code></pre></div><pre><code class=language-log data-lang=log>----------------------------------------------------------------------------------------------------
| Node Count: 9 | Replication Factor: 3                                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.1:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh                                               |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh                                               |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli                                            |
| Web UI              : http://127.0.0.1:7000/                                                     |
| Cluster Data        : /tmp/demo/data                                                             |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 1: yb-tserver (pid 90648), yb-master (pid 90639)                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.1:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh                                               |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh                                               |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli                                            |
| data-dir[0]         : /tmp/demo/data/node-1/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-1/disk-1/yb-data/tserver/logs                          |
| yb-master Logs      : /tmp/demo/data/node-1/disk-1/yb-data/master/logs                           |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 2: yb-tserver (pid 90651), yb-master (pid 90642)                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.2:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.2                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.2                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.2                               |
| data-dir[0]         : /tmp/demo/data/node-2/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-2/disk-1/yb-data/tserver/logs                          |
| yb-master Logs      : /tmp/demo/data/node-2/disk-1/yb-data/master/logs                           |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 3: yb-tserver (pid 90654), yb-master (pid 90645)                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.3:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.3                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.3                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.3                               |
| data-dir[0]         : /tmp/demo/data/node-3/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-3/disk-1/yb-data/tserver/logs                          |
| yb-master Logs      : /tmp/demo/data/node-3/disk-1/yb-data/master/logs                           |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 4: yb-tserver (pid 91265)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.4:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.4                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.4                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.4                               |
| data-dir[0]         : /tmp/demo/data/node-4/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-4/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 5: yb-tserver (pid 91323)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.5:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.5                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.5                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.5                               |
| data-dir[0]         : /tmp/demo/data/node-5/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-5/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 6: yb-tserver (pid 91385)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.6:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.6                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.6                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.6                               |
| data-dir[0]         : /tmp/demo/data/node-6/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-6/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 7: yb-tserver (pid 91449)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.7:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.7                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.7                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.7                               |
| data-dir[0]         : /tmp/demo/data/node-7/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-7/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 8: yb-tserver (pid 91495)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.8:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.8                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.8                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.8                               |
| data-dir[0]         : /tmp/demo/data/node-8/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-8/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 9: yb-tserver (pid 91549)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.9:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.9                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.9                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.9                               |
| data-dir[0]         : /tmp/demo/data/node-9/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-9/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
</code></pre></li><li><p>(Optional) Check the TServers details by clicking <strong>Home > Overview > (See all nodes)</strong> <a href=http://127.0.0.1:7000/tablet-servers>or click here</a></p><p><figure><picture>
<img class="image_figure image_internal" src=/2022/03/17/yugabyte-row-level-geo-partitioning/05-tserver-9-nodes.png alt="TServers with 9 nodes" loading=lazy decoding=async width=1733 height=1767></picture></figure></p></li></ol><p>Now we have created a multi-region cluster across 3 regions and 9 zones. Each zone has 1 node in it. Table below shows Region/Zone wise list of nodes with roles.</p><table><thead><tr><th>Region</th><th>Zone</th><th>IP</th><th>Role</th></tr></thead><tbody><tr><td>ap-south-1</td><td>ap-south-1a</td><td>127.0.0.3</td><td>master,tserver</td></tr><tr><td>ap-south-1</td><td>ap-south-1b</td><td>127.0.0.8</td><td>tserver</td></tr><tr><td>ap-south-1</td><td>ap-south-1c</td><td>127.0.0.9</td><td>tserver</td></tr><tr><td>us-west-2</td><td>us-west-2a</td><td>127.0.0.1</td><td>master,tserver</td></tr><tr><td>us-west-2</td><td>us-west-2b</td><td>127.0.0.4</td><td>tserver</td></tr><tr><td>us-west-2</td><td>us-west-2c</td><td>127.0.0.5</td><td>tserver</td></tr><tr><td>eu-central-1</td><td>eu-central-1a</td><td>127.0.0.2</td><td>master,tserver</td></tr><tr><td>eu-central-1</td><td>eu-central-1b</td><td>127.0.0.6</td><td>tserver</td></tr><tr><td>eu-central-1</td><td>eu-central-1c</td><td>127.0.0.7</td><td>tserver</td></tr></tbody></table><h2 id=example-1---global-transactions>Example 1 - Global Transactions</h2><p>In this exercise, we will create a single <strong>bank_transactions</strong> table. Out aim is to place the transaction records for each geo in its own nodes. This is simulating the enforcement of data privacy/sovereignty rules with in a single database. We will use SQL queries to simulate application interactions.</p><p>Lets launch YSQL Shell to perform all the SQL query operations.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ysqlsh
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>ysqlsh (11.2-YB-2.13.0.0-b0)
Type &quot;help&quot; for help.

yugabyte=#
</code></pre><p>You may exit <strong>YSQL Shell</strong> anytime by typing <code>\q&lt;enter></code>, <code>&lt;ctrl>+d</code> or <code>quit;&lt;enter></code>.</p><h3 id=setup-tablespace-for-each-geo>Setup tablespace for each geo</h3><ol><li><p>Create geo-partitioned tablespace for <code>us-west-2</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> TABLESPACE us_west_2_tablespace <span style=color:#66d9ef>WITH</span> (
  replica_placement<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{&#34;num_replicas&#34;: 3, &#34;placement_blocks&#34;:
</span><span style=color:#e6db74>  [{&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;us-west-2&#34;,&#34;zone&#34;:&#34;us-west-2a&#34;,&#34;min_num_replicas&#34;:1},
</span><span style=color:#e6db74>  {&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;us-west-2&#34;,&#34;zone&#34;:&#34;us-west-2b&#34;,&#34;min_num_replicas&#34;:1},
</span><span style=color:#e6db74>  {&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;us-west-2&#34;,&#34;zone&#34;:&#34;us-west-2c&#34;,&#34;min_num_replicas&#34;:1}]}&#39;</span>
);
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLESPACE
</code></pre></li><li><p>Create geo-partitioned tablespace for <code>eu-central-1</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>
<span style=color:#66d9ef>CREATE</span> TABLESPACE eu_central_1_tablespace <span style=color:#66d9ef>WITH</span> (
  replica_placement<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{&#34;num_replicas&#34;: 3, &#34;placement_blocks&#34;:
</span><span style=color:#e6db74>  [{&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;eu-central-1&#34;,&#34;zone&#34;:&#34;eu-central-1a&#34;,&#34;min_num_replicas&#34;:1},
</span><span style=color:#e6db74>  {&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;eu-central-1&#34;,&#34;zone&#34;:&#34;eu-central-1b&#34;,&#34;min_num_replicas&#34;:1},
</span><span style=color:#e6db74>  {&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;eu-central-1&#34;,&#34;zone&#34;:&#34;eu-central-1c&#34;,&#34;min_num_replicas&#34;:1}]}&#39;</span>
);
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLESPACE
</code></pre></li><li><p>Create geo-partitioned tablespace for <code>ap-south-1</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> TABLESPACE ap_south_1_tablespace <span style=color:#66d9ef>WITH</span> (
  replica_placement<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{&#34;num_replicas&#34;: 3, &#34;placement_blocks&#34;:
</span><span style=color:#e6db74>  [{&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;ap-south-1&#34;,&#34;zone&#34;:&#34;ap-south-1a&#34;,&#34;min_num_replicas&#34;:1},
</span><span style=color:#e6db74>  {&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;ap-south-1&#34;,&#34;zone&#34;:&#34;ap-south-1b&#34;,&#34;min_num_replicas&#34;:1},
</span><span style=color:#e6db74>  {&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;ap-south-1&#34;,&#34;zone&#34;:&#34;ap-south-1c&#34;,&#34;min_num_replicas&#34;:1}]}&#39;</span>
);
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLESPACE
</code></pre></li><li><p>(Optional) List all the tablespaces</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span>db
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>              List of tablespaces
          Name           |  Owner   | Location
-------------------------+----------+----------
 ap_south_1_tablespace   | yugabyte |
 eu_central_1_tablespace | yugabyte |
 pg_default              | postgres |
 pg_global               | postgres |
 us_west_2_tablespace    | yugabyte |
(5 rows)

</code></pre></li></ol><h3 id=create-transaction-table-and-partitions>Create Transaction Table and Partitions</h3><ol><li><p>Create <code>bank_transaction</code> table</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> bank_transactions (
    user_id   INTEGER <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
    account_id INTEGER <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
    geo_partition VARCHAR,
    account_type VARCHAR <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
    amount NUMERIC <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
    txn_type VARCHAR <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
    created_at <span style=color:#66d9ef>TIMESTAMP</span> <span style=color:#66d9ef>DEFAULT</span> NOW()
) PARTITION <span style=color:#66d9ef>BY</span> LIST (geo_partition);

</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLE
</code></pre></li><li><p>Setup table partition for <code>US</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> bank_transactions_us
    PARTITION <span style=color:#66d9ef>OF</span> bank_transactions
      (user_id, account_id, geo_partition, account_type,
      amount, txn_type, created_at,
      <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (user_id HASH, account_id, geo_partition))
    <span style=color:#66d9ef>FOR</span> <span style=color:#66d9ef>VALUES</span> <span style=color:#66d9ef>IN</span> (<span style=color:#e6db74>&#39;US&#39;</span>) TABLESPACE us_west_2_tablespace;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLE
</code></pre></li><li><p>Setup table partition for <code>EU</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> bank_transactions_eu
    PARTITION <span style=color:#66d9ef>OF</span> bank_transactions
      (user_id, account_id, geo_partition, account_type,
      amount, txn_type, created_at,
      <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (user_id HASH, account_id, geo_partition))
    <span style=color:#66d9ef>FOR</span> <span style=color:#66d9ef>VALUES</span> <span style=color:#66d9ef>IN</span> (<span style=color:#e6db74>&#39;EU&#39;</span>) TABLESPACE eu_central_1_tablespace;

</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLE
</code></pre></li><li><p>Setup table partition for <code>India</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> bank_transactions_india
    PARTITION <span style=color:#66d9ef>OF</span> bank_transactions
      (user_id, account_id, geo_partition, account_type,
      amount, txn_type, created_at,
      <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (user_id HASH, account_id, geo_partition))
    <span style=color:#66d9ef>FOR</span> <span style=color:#66d9ef>VALUES</span> <span style=color:#66d9ef>IN</span> (<span style=color:#e6db74>&#39;India&#39;</span>) TABLESPACE ap_south_1_tablespace;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLE
</code></pre></li><li><p>(Optional) List all the relations (tables/partitions/etc.)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span>d
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>                   List of relations
 Schema |           Name            | Type  |  Owner
--------+---------------------------+-------+----------
 public | bank_transactions         | table | yugabyte
 public | bank_transactions_eu      | table | yugabyte
 public | bank_transactions_india   | table | yugabyte
 public | bank_transactions_us      | table | yugabyte
(4 rows)
</code></pre></li><li><p>(Optional) Get details of <code>bank_transactions</code> table</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span>d<span style=color:#f92672>+</span> bank_transactions
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>                                           Table &quot;public.bank_transactions&quot;
    Column     |            Type             | Collation | Nullable | Default | Storage  | Stats target | Description
---------------+-----------------------------+-----------+----------+---------+----------+--------------+-------------
 user_id       | integer                     |           | not null |         | plain    |              |
 account_id    | integer                     |           | not null |         | plain    |              |
 geo_partition | character varying           |           |          |         | extended |              |
 account_type  | character varying           |           | not null |         | extended |              |
 amount        | numeric                     |           | not null |         | main     |              |
 txn_type      | character varying           |           | not null |         | extended |              |
 created_at    | timestamp without time zone |           |          | now()   | plain    |              |
Partition key: LIST (geo_partition)
Partitions: bank_transactions_eu FOR VALUES IN ('EU'),
            bank_transactions_india FOR VALUES IN ('India'),
            bank_transactions_us FOR VALUES IN ('US'),
</code></pre></li><li><p>(Optional) On the <a href=http://127.0.0.1>Master UI</a>, check the table configuration by clicking <strong>Home > Overview > (See all tables)</strong> <a href=http://127.0.0.1:7000/tables>or click here</a>.</p><p><strong>Screenshot</strong></p><p><figure><picture>
<img class="image_figure image_internal" src=/2022/03/17/yugabyte-row-level-geo-partitioning/06-tables.png alt="Tables after creating partitions" loading=lazy decoding=async width=1739 height=419></picture></figure></p><ol><li><p>Click on <code>bank_transaction</code> to see that table settings. Some of the things to note here are:</p><ol><li><p>Replication Config is same as the cluster level replication configuration.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#ae81ff>live_replicas {</span>
  <span style=color:#f92672>num_replicas</span>: <span style=color:#ae81ff>3</span>
  <span style=color:#ae81ff>placement_blocks {</span>
    <span style=color:#ae81ff>cloud_info {</span>
      <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
      <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;eu-central-1&#34;</span>
      <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;eu-central-1a&#34;</span>
    }
    <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
  }
  <span style=color:#ae81ff>placement_blocks {</span>
    <span style=color:#ae81ff>cloud_info {</span>
      <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
      <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;ap-south-1&#34;</span>
      <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;ap-south-1a&#34;</span>
    }
    <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
  }
  <span style=color:#ae81ff>placement_blocks {</span>
    <span style=color:#ae81ff>cloud_info {</span>
      <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
      <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;us-west-2&#34;</span>
      <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;us-west-2a&#34;</span>
    }
    <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
  }
}
</code></pre></div></li><li><p>All the tablet groups are configured to be spread across multiple-regions (<code>us-west-2</code>, <code>eu-central-1</code> and <code>ap-south-1</code>) with IPs <code>127.0.0.1</code>, <code>127.0.0.2</code> and <code>127.0.0.3</code>.</p></li><li><p>All the data going into this table by default will be spread across multiple-regions (<code>us-west-2</code>, <code>eu-central-1</code> and <code>ap-south-1</code>).</p></li></ol></li><li><p><a href=http://127.0.0.1:7000/tables>Back on the table list</a>, click on <code>bank_transactions_eu</code> to see the partition configuration. Here, you will notice:</p><ol><li><p>Replication config is not same as the cluster level config. Instead its same as <code>replica_placement</code> value in the <code>eu_central_1_tablespace</code> definition.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#ae81ff>live_replicas {</span>
  <span style=color:#f92672>num_replicas</span>: <span style=color:#ae81ff>3</span>
  <span style=color:#ae81ff>placement_blocks {</span>
    <span style=color:#ae81ff>cloud_info {</span>
      <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
      <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;eu-central-1&#34;</span>
      <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;eu-central-1a&#34;</span>
    }
    <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
  }
  <span style=color:#ae81ff>placement_blocks {</span>
    <span style=color:#ae81ff>cloud_info {</span>
      <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
      <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;eu-central-1&#34;</span>
      <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;eu-central-1b&#34;</span>
    }
    <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
  }
  <span style=color:#ae81ff>placement_blocks {</span>
    <span style=color:#ae81ff>cloud_info {</span>
      <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
      <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;eu-central-1&#34;</span>
      <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;eu-central-1c&#34;</span>
    }
    <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
  }
}
</code></pre></div></li><li><p>All the tablet groups are configured to be spread across nodes in <code>eu-central-1</code> region (<code>127.0.0.2</code>, <code>127.0.0.6</code> and <code>127.0.0.7</code>).</p></li><li><p>All the data going into this partition will be placed only in <code>eu-central-1</code> regional nodes.</p></li></ol></li></ol></li></ol><p>We have now finished setup for the table, partitions and tablespaces for all the regions now. Lets proceed with transaction simulations.</p><h3 id=scenario--single-row-transaction>Scenario : Single Row Transaction</h3><ol><li><p>Launch YSQL Shell</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ysqlsh
</code></pre></div></li><li><p>Create transaction record for <code>EU</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions
    <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>10001</span>, <span style=color:#e6db74>&#39;EU&#39;</span>, <span style=color:#e6db74>&#39;checking&#39;</span>, <span style=color:#ae81ff>120</span>.<span style=color:#ae81ff>50</span>, <span style=color:#e6db74>&#39;debit&#39;</span>);
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>INSERT 0 1
</code></pre></li><li><p>Examine <code>EU</code> partition</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> bank_transactions_eu;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log> user_id | account_id | geo_partition | account_type | amount | txn_type |         created_at
---------+------------+---------------+--------------+--------+----------+----------------------------
     100 |      10001 | EU            | checking     |  120.5 | debit    | 2022-03-17 20:36:05.603271
(1 row)
</code></pre></li><li><p>And lets check other <code>India</code> geo partitions also</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>FROM</span> bank_transactions_india;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log> count
-------
     0
(1 row)
</code></pre></li><li><p>Also check the <code>US</code> partition</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>COUNT</span>(<span style=color:#f92672>*</span>) <span style=color:#66d9ef>FROM</span> bank_transactions_us;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log> count
-------
     0
(1 row)
</code></pre></li></ol><h3 id=scenario-multiple-single-row-transactions>Scenario: Multiple Single Row Transactions</h3><ol><li><p>Lets create a multi-geo transactions. This is what you would in in a connection pool / connection reuse scenario of you application.</p><p><em>Copy/Paste one row at a time, otherwise output is mangled</em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions
    <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>20001</span>, <span style=color:#e6db74>&#39;India&#39;</span>, <span style=color:#e6db74>&#39;savings&#39;</span>, <span style=color:#ae81ff>2000</span>, <span style=color:#e6db74>&#39;credit&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions
    <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>300</span>, <span style=color:#ae81ff>30001</span>, <span style=color:#e6db74>&#39;US&#39;</span>, <span style=color:#e6db74>&#39;checking&#39;</span>,  <span style=color:#ae81ff>105</span>.<span style=color:#ae81ff>25</span>, <span style=color:#e6db74>&#39;debit&#39;</span>);
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>INSERT 0 1
INSERT 0 1
</code></pre></li><li><p>Lets look at the transaction in <code>India</code> partition</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> bank_transactions_india;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log> user_id | account_id | geo_partition | account_type | amount | txn_type |         created_at
---------+------------+---------------+--------------+--------+----------+----------------------------
     200 |      20001 | India         | savings      |   2000 | credit   | 2022-03-17 22:37:10.318521
(1 row)
</code></pre></li><li><p>Lets look at the transaction in <code>US</code> partition</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> bank_transactions_us;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log> user_id | account_id | geo_partition | account_type | amount | txn_type |         created_at
---------+------------+---------------+--------------+--------+----------+----------------------------
     300 |      30001 | US            | checking     | 105.25 | debit    | 2022-03-17 22:37:11.49277
(1 row)

</code></pre></li><li><p>Lets look at the whole table with the data locations</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> tableoid::regclass, <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> bank_transactions;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>        tableoid         | user_id | account_id | geo_partition | account_type | amount | txn_type |         created_at
-------------------------+---------+------------+---------------+--------------+--------+----------+----------------------------
 bank_transactions_eu    |     100 |      10001 | EU            | checking     |  120.5 | debit    | 2022-03-17 20:36:05.603271
 bank_transactions_india |     200 |      20001 | India         | savings      |   2000 | credit   | 2022-03-17 22:37:10.318521
 bank_transactions_us    |     300 |      30001 | US            | checking     | 105.25 | debit    | 2022-03-17 22:37:11.492779
(3 rows)

</code></pre><p><code>tableoid::regclass</code> is a special expression in PostgresSQL for listing the location / partition of a row. Things to notice here are:</p><ol><li>We can access all the transactions via table <code>bank_transactions</code>.</li><li>We ensured that data for a geo (Example: <code>EU</code>) is in the partition of that geo <code>EU</code> partition. And, <code>EU</code> partition is setup such that it will be created on <code>EU</code> tablespace. <code>EU</code> tablespace is configured to have its data place in <code>eu-central-1</code> region, across <code>eu-central-1a</code>, <code>eu-central-1b</code> and <code>eu-central-1c</code> zone.</li></ol></li></ol><h3 id=scenario---multi-row-transactions>Scenario - Multi Row Transactions</h3><ol><li><p>Let try to multi-row transaction. Remember we are connected to <code>127.0.0.1</code> node, which is in <code>us-west-2a</code>.</p><p><em>Copy/Paste one row at a time, otherwise output is mangled</em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>BEGIN</span>;
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>10002</span>, <span style=color:#e6db74>&#39;EU&#39;</span>, <span style=color:#e6db74>&#39;checking&#39;</span>, <span style=color:#ae81ff>400</span>.<span style=color:#ae81ff>00</span>, <span style=color:#e6db74>&#39;debit&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>10003</span>, <span style=color:#e6db74>&#39;EU&#39;</span>, <span style=color:#e6db74>&#39;checking&#39;</span>, <span style=color:#ae81ff>400</span>.<span style=color:#ae81ff>00</span>, <span style=color:#e6db74>&#39;credit&#39;</span>);
<span style=color:#66d9ef>COMMIT</span>;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>ERROR:  Illegal state: Nonlocal tablet accessed in local transaction: tablet &lt;hex-number&gt;: . Errors from tablet servers: [Illegal state (yb/client/transaction.cc:288): Nonlocal tablet accessed in local transaction: tablet &lt;hex-number&gt;]
</code></pre><p>This fails, as we do not allows cross geo-transaction for multi-row transaction - by default. But we have inserted data for <code>EU</code>, <code>India</code> and <code>Singapore</code> through <code>us-west-2a</code> node, then why that worked? Well, this is because of optimization in Yugabyte for single row transactions. As per the docs:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>The transaction manager of YugabyteDB automatically detects transactions that
update a single row (as opposed to transactions that update rows across tablets
or nodes). In order to achieve high performance, the updates to a single row
directly update the row without having to interact with the transaction status
tablet using the single row transaction path, also called the fast path.
</code></pre></div><p><a href=https://docs.yugabyte.com/latest/architecture/transactions/transactions-overview/#single-row-transactions>Goto Source</a></p></li><li><p>Connect to a node in <code>eu-central-1</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#ae81ff>\c</span> - - 127.0.0.2
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>You are now connected to database &quot;yugabyte&quot; as user &quot;yugabyte&quot; on host &quot;127.0.0.2&quot; at port &quot;5433&quot;.
</code></pre><p><strong>Note:</strong> You could quit shell and connect to node via argument. But <code>\c</code> is doing the same thing really.</p></li><li><p>Let try again</p><p><em>Copy/Paste one row at a time, otherwise output is mangled</em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>BEGIN</span>;
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>10002</span>, <span style=color:#e6db74>&#39;EU&#39;</span>, <span style=color:#e6db74>&#39;checking&#39;</span>, <span style=color:#ae81ff>400</span>.<span style=color:#ae81ff>00</span>, <span style=color:#e6db74>&#39;debit&#39;</span>);
<span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>10003</span>, <span style=color:#e6db74>&#39;EU&#39;</span>, <span style=color:#e6db74>&#39;checking&#39;</span>, <span style=color:#ae81ff>400</span>.<span style=color:#ae81ff>00</span>, <span style=color:#e6db74>&#39;credit&#39;</span>);
<span style=color:#66d9ef>COMMIT</span>;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>BEGIN
INSERT 0 1
INSERT 0 1
COMMIT
</code></pre><p>That worked.</p></li><li><p>Lets check that transactions:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> tableoid::regclass, <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> bank_transactions <span style=color:#66d9ef>where</span> account_id <span style=color:#66d9ef>in</span> (<span style=color:#e6db74>&#39;10002&#39;</span>,<span style=color:#e6db74>&#39;10003&#39;</span>);
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>       tableoid       | user_id | account_id | geo_partition | account_type | amount | txn_type |         created_at
----------------------+---------+------------+---------------+--------------+--------+----------+----------------------------
 bank_transactions_eu |     100 |      10002 | EU            | checking     |    400 | debit    | 2022-03-17 22:43:37.235321
 bank_transactions_eu |     100 |      10003 | EU            | checking     |    400 | credit   | 2022-03-17 22:43:37.235321
(2 rows)
</code></pre></li></ol><h3 id=scenario--multi-row---multi-region-transactions>Scenario : Multi Row - Multi region transactions</h3><p>Sometimes you may need to run queries for cross region data spanning across multiple rows. From previous scenario we saw that we have to connect to an <code>EU</code> node for working with multiple rows in <code>EU</code>. Then, what about transactions spanning across geo?</p><p>Lets try to do a cross geo-transaction (<code>US</code> x <code>EU</code>) from a third geo (<code>India</code>).</p><ol><li><p>Let connect to an <code>India</code> node</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span><span style=color:#66d9ef>c</span> <span style=color:#f92672>-</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>127</span>.<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>3</span>

</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>You are now connected to database &quot;yugabyte&quot; as user &quot;yugabyte&quot; on host &quot;127.0.0.3&quot; at port &quot;5433&quot;.
</code></pre></li><li><p>Set <code>force_global_transaction</code> to <code>TRUE</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SET</span> force_global_transaction <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>SET
</code></pre></li><li><p>Lets run the cross geo transaction as follows</p><p><em>Copy/Paste one row at a time, otherwise output is mangled</em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>  <span style=color:#66d9ef>BEGIN</span>;
  <span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>10004</span>, <span style=color:#e6db74>&#39;US&#39;</span>, <span style=color:#e6db74>&#39;checking&#39;</span>, <span style=color:#ae81ff>400</span>.<span style=color:#ae81ff>00</span>, <span style=color:#e6db74>&#39;debit&#39;</span>);
  <span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>10005</span>, <span style=color:#e6db74>&#39;EU&#39;</span>, <span style=color:#e6db74>&#39;checking&#39;</span>, <span style=color:#ae81ff>400</span>.<span style=color:#ae81ff>00</span>, <span style=color:#e6db74>&#39;credit&#39;</span>);
  <span style=color:#66d9ef>COMMIT</span>;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>BEGIN
INSERT 0 1
INSERT 0 1
COMMIT
</code></pre></li><li><p>Check the transactions</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> tableoid::regclass, <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> bank_transactions <span style=color:#66d9ef>where</span> account_id <span style=color:#66d9ef>in</span> (<span style=color:#e6db74>&#39;10004&#39;</span>,<span style=color:#e6db74>&#39;10005&#39;</span>);
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>       tableoid       | user_id | account_id | geo_partition | account_type | amount | txn_type |         created_at
----------------------+---------+------------+---------------+--------------+--------+----------+----------------------------
 bank_transactions_eu |     200 |      10005 | EU            | checking     |    400 | credit   | 2022-03-17 22:52:33.346504
 bank_transactions_us |     100 |      10004 | US            | checking     |    400 | debit    | 2022-03-17 22:52:33.346504
(2 rows)

</code></pre></li></ol><h3 id=scenario--add-new-region>Scenario : Add new region</h3><ol><li><p>Quit YSQL shell</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>quit;
</code></pre></div></li><li><p>Add tablet server for a new region - South America(sa-east-1)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yb-ctl --data_dir $PWD/data add_node --placement_info <span style=color:#e6db74>&#34;aws.sa-east-1.sa-east-1a&#34;</span>
yb-ctl --data_dir $PWD/data add_node --placement_info <span style=color:#e6db74>&#34;aws.sa-east-1.sa-east-1b&#34;</span>
yb-ctl --data_dir $PWD/data add_node --placement_info <span style=color:#e6db74>&#34;aws.sa-east-1.sa-east-1c&#34;</span>
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 10: yb-tserver (pid 96765)                                                                  |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.10:5433/yugabyte                                 |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.10                                 |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.10                                    |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.10                              |
| data-dir[0]         : /tmp/demo/data/node-10/disk-1/yb-data                                      |
| yb-tserver Logs     : /tmp/demo/data/node-10/disk-1/yb-data/tserver/logs                         |
----------------------------------------------------------------------------------------------------
Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 11: yb-tserver (pid 96826)                                                                  |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.11:5433/yugabyte                                 |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.11                                 |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.11                                    |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.11                              |
| data-dir[0]         : /tmp/demo/data/node-11/disk-1/yb-data                                      |
| yb-tserver Logs     : /tmp/demo/data/node-11/disk-1/yb-data/tserver/logs                         |
----------------------------------------------------------------------------------------------------
Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 12: yb-tserver (pid 96895)                                                                  |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.12:5433/yugabyte                                 |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.12                                 |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.12                                    |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.12                              |
| data-dir[0]         : /tmp/demo/data/node-12/disk-1/yb-data                                      |
| yb-tserver Logs     : /tmp/demo/data/node-12/disk-1/yb-data/tserver/logs                         |
----------------------------------------------------------------------------------------------------
</code></pre></li><li><p>Check cluster status</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yb-ctl status --data_dir $PWD/data
</code></pre></div><pre><code class=language-log data-lang=log>----------------------------------------------------------------------------------------------------
| Node Count: 12 | Replication Factor: 3                                                           |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.1:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh                                               |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh                                               |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli                                            |
| Web UI              : http://127.0.0.1:7000/                                                     |
| Cluster Data        : /tmp/demo/data                                                             |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 1: yb-tserver (pid 90648), yb-master (pid 90639)                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.1:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh                                               |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh                                               |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli                                            |
| data-dir[0]         : /tmp/demo/data/node-1/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-1/disk-1/yb-data/tserver/logs                          |
| yb-master Logs      : /tmp/demo/data/node-1/disk-1/yb-data/master/logs                           |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 2: yb-tserver (pid 90651), yb-master (pid 90642)                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.2:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.2                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.2                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.2                               |
| data-dir[0]         : /tmp/demo/data/node-2/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-2/disk-1/yb-data/tserver/logs                          |
| yb-master Logs      : /tmp/demo/data/node-2/disk-1/yb-data/master/logs                           |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 3: yb-tserver (pid 90654), yb-master (pid 90645)                                            |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.3:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.3                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.3                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.3                               |
| data-dir[0]         : /tmp/demo/data/node-3/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-3/disk-1/yb-data/tserver/logs                          |
| yb-master Logs      : /tmp/demo/data/node-3/disk-1/yb-data/master/logs                           |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 4: yb-tserver (pid 91265)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.4:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.4                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.4                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.4                               |
| data-dir[0]         : /tmp/demo/data/node-4/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-4/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 5: yb-tserver (pid 91323)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.5:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.5                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.5                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.5                               |
| data-dir[0]         : /tmp/demo/data/node-5/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-5/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 6: yb-tserver (pid 91385)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.6:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.6                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.6                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.6                               |
| data-dir[0]         : /tmp/demo/data/node-6/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-6/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 7: yb-tserver (pid 91449)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.7:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.7                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.7                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.7                               |
| data-dir[0]         : /tmp/demo/data/node-7/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-7/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 8: yb-tserver (pid 91495)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.8:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.8                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.8                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.8                               |
| data-dir[0]         : /tmp/demo/data/node-8/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-8/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 9: yb-tserver (pid 91549)                                                                   |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.9:5433/yugabyte                                  |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.9                                  |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.9                                     |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.9                               |
| data-dir[0]         : /tmp/demo/data/node-9/disk-1/yb-data                                       |
| yb-tserver Logs     : /tmp/demo/data/node-9/disk-1/yb-data/tserver/logs                          |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 10: yb-tserver (pid 96765)                                                                  |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.10:5433/yugabyte                                 |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.10                                 |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.10                                    |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.10                              |
| data-dir[0]         : /tmp/demo/data/node-10/disk-1/yb-data                                      |
| yb-tserver Logs     : /tmp/demo/data/node-10/disk-1/yb-data/tserver/logs                         |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 11: yb-tserver (pid 96826)                                                                  |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.11:5433/yugabyte                                 |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.11                                 |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.11                                    |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.11                              |
| data-dir[0]         : /tmp/demo/data/node-11/disk-1/yb-data                                      |
| yb-tserver Logs     : /tmp/demo/data/node-11/disk-1/yb-data/tserver/logs                         |
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
| Node 12: yb-tserver (pid 96895)                                                                  |
----------------------------------------------------------------------------------------------------
| JDBC                : jdbc:postgresql://127.0.0.12:5433/yugabyte                                 |
| YSQL Shell          : yugabyte-2.13.0.0/bin/ysqlsh -h 127.0.0.12                                 |
| YCQL Shell          : yugabyte-2.13.0.0/bin/ycqlsh 127.0.0.12                                    |
| YEDIS Shell         : yugabyte-2.13.0.0/bin/redis-cli -h 127.0.0.12                              |
| data-dir[0]         : /tmp/demo/data/node-12/disk-1/yb-data                                      |
| yb-tserver Logs     : /tmp/demo/data/node-12/disk-1/yb-data/tserver/logs                         |
----------------------------------------------------------------------------------------------------
</code></pre></li><li><p>Launch SQL Shell</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ysqlsh
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>ysqlsh (11.2-YB-2.13.0.0-b0)
Type &quot;help&quot; for help.

yugabyte=#
</code></pre></li><li><p>Create a tablespace that spans across new region/zones</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>
<span style=color:#66d9ef>CREATE</span> TABLESPACE sa_east_1_tablespace <span style=color:#66d9ef>WITH</span> (
    replica_placement<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{&#34;num_replicas&#34;: 3, &#34;placement_blocks&#34;:
</span><span style=color:#e6db74>      [{&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;sa-east-1&#34;,&#34;zone&#34;:&#34;sa-east-1a&#34;,&#34;min_num_replicas&#34;:1},
</span><span style=color:#e6db74>      {&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;sa-east-1&#34;,&#34;zone&#34;:&#34;sa-east-1b&#34;,&#34;min_num_replicas&#34;:1},
</span><span style=color:#e6db74>      {&#34;cloud&#34;:&#34;aws&#34;,&#34;region&#34;:&#34;sa-east-1&#34;,&#34;zone&#34;:&#34;sa-east-1c&#34;,&#34;min_num_replicas&#34;:1}]}&#39;</span>
    );

</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLESPACE
</code></pre></li><li><p>(Optional) List all the tablespaces</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span>db<span style=color:#960050;background-color:#1e0010>\</span>
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>              List of tablespaces
          Name           |  Owner   | Location
-------------------------+----------+----------
 ap_south_1_tablespace   | yugabyte |
 eu_central_1_tablespace | yugabyte |
 pg_default              | postgres |
 pg_global               | postgres |
 sa_east_1_tablespace    | yugabyte |
 us_west_2_tablespace    | yugabyte |
(6 rows)
</code></pre></li><li><p>Create partition on <code>bank_transactions</code> table that uses new tablespace <code>sa_east_1_tablespace</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> bank_transactions_brazil
    PARTITION <span style=color:#66d9ef>OF</span> bank_transactions
      (user_id, account_id, geo_partition, account_type,
      amount, txn_type, created_at,
      <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (user_id HASH, account_id, geo_partition))
    <span style=color:#66d9ef>FOR</span> <span style=color:#66d9ef>VALUES</span> <span style=color:#66d9ef>IN</span> (<span style=color:#e6db74>&#39;Brazil&#39;</span>) TABLESPACE sa_east_1_tablespace;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLE
</code></pre></li><li><p>(Optional) List all the relations (tables/partitions/etc.)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span>d
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>                  List of relations
 Schema |           Name           | Type  |  Owner
--------+--------------------------+-------+----------
 public | bank_transactions        | table | yugabyte
 public | bank_transactions_brazil | table | yugabyte
 public | bank_transactions_eu     | table | yugabyte
 public | bank_transactions_india  | table | yugabyte
 public | bank_transactions_us     | table | yugabyte
(5 rows)

</code></pre></li><li><p>(Optional) Get details of <code>bank_transactions</code> table</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span>d<span style=color:#f92672>+</span> bank_transactions
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>                                           Table &quot;public.bank_transactions&quot;
    Column     |            Type             | Collation | Nullable | Default | Storage  | Stats target | Description
---------------+-----------------------------+-----------+----------+---------+----------+--------------+-------------
 user_id       | integer                     |           | not null |         | plain    |              |
 account_id    | integer                     |           | not null |         | plain    |              |
 geo_partition | character varying           |           |          |         | extended |              |
 account_type  | character varying           |           | not null |         | extended |              |
 amount        | numeric                     |           | not null |         | main     |              |
 txn_type      | character varying           |           | not null |         | extended |              |
 created_at    | timestamp without time zone |           |          | now()   | plain    |              |
Partition key: LIST (geo_partition)
Partitions: bank_transactions_brazil FOR VALUES IN ('Brazil'),
            bank_transactions_eu FOR VALUES IN ('EU'),
            bank_transactions_india FOR VALUES IN ('India'),
            bank_transactions_us FOR VALUES IN ('US')

</code></pre></li><li><p>Insert transactions</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions
    <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>400</span>, <span style=color:#ae81ff>40001</span>, <span style=color:#e6db74>&#39;Brazil&#39;</span>, <span style=color:#e6db74>&#39;savings&#39;</span>, <span style=color:#ae81ff>1000</span>, <span style=color:#e6db74>&#39;credit&#39;</span>);
</code></pre></div></li><li><p>Check record transactions</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> tableoid::regclass, <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> bank_transactions;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>         tableoid         | user_id | account_id | geo_partition | account_type | amount | txn_type |         created_at
--------------------------+---------+------------+---------------+--------------+--------+----------+----------------------------
 bank_transactions_brazil |     400 |      40001 | Brazil        | savings      |   1000 | credit   | 2022-03-17 23:18:48.225731
 bank_transactions_eu     |     200 |      10005 | EU            | checking     |    400 | credit   | 2022-03-17 22:52:33.346504
 bank_transactions_eu     |     100 |      10001 | EU            | checking     |  120.5 | debit    | 2022-03-17 20:36:05.603271
 bank_transactions_eu     |     100 |      10002 | EU            | checking     |    400 | debit    | 2022-03-17 22:43:37.235321
 bank_transactions_eu     |     100 |      10003 | EU            | checking     |    400 | credit   | 2022-03-17 22:43:37.235321
 bank_transactions_india  |     200 |      20001 | India         | savings      |   2000 | credit   | 2022-03-17 22:37:10.318521
 bank_transactions_us     |     100 |      10004 | US            | checking     |    400 | debit    | 2022-03-17 22:52:33.346504
 bank_transactions_us     |     300 |      30001 | US            | checking     | 105.25 | debit    | 2022-03-17 22:37:11.492779
(8 rows)

</code></pre></li></ol><h3 id=scenario-transaction-for-unknown-geo>Scenario: Transaction for Unknown Geo</h3><ol><li><p>Lets try to insert a record for a <code>Singapore</code> and see what happens</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql> <span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions
    <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>500</span>, <span style=color:#ae81ff>50001</span>, <span style=color:#e6db74>&#39;Singapore&#39;</span>, <span style=color:#e6db74>&#39;savings&#39;</span>, <span style=color:#ae81ff>2000</span>, <span style=color:#e6db74>&#39;credit&#39;</span>);
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>ERROR:  no partition of relation &quot;bank_transactions&quot; found for row
DETAIL:  Partition key of the failing row contains (geo_partition) = (Singapore).
</code></pre><p>This is because there is no <code>default</code> partition on the table.</p></li><li><p>Lets create a default partition on <code>bank_transactions</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> bank_transactions_default
   PARTITION <span style=color:#66d9ef>OF</span> bank_transactions
     (user_id, account_id, geo_partition, account_type,
     amount, txn_type, created_at,
     <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (user_id HASH, account_id, geo_partition))
   <span style=color:#66d9ef>DEFAULT</span>;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>CREATE TABLE
</code></pre></li><li><p>(Optional) List all the relations (tables/partitions/etc.)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span>d
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>                   List of relations
 Schema |           Name            | Type  |  Owner
--------+---------------------------+-------+----------
 public | bank_transactions         | table | yugabyte
 public | bank_transactions_brazil  | table | yugabyte
 public | bank_transactions_default | table | yugabyte
 public | bank_transactions_eu      | table | yugabyte
 public | bank_transactions_india   | table | yugabyte
 public | bank_transactions_us      | table | yugabyte
(6 rows)

</code></pre></li><li><p>(Optional) Get details of <code>bank_transactions</code> table</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span>d<span style=color:#f92672>+</span> bank_transactions
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>                                           Table &quot;public.bank_transactions&quot;
    Column     |            Type             | Collation | Nullable | Default | Storage  | Stats target | Description
---------------+-----------------------------+-----------+----------+---------+----------+--------------+-------------
 user_id       | integer                     |           | not null |         | plain    |              |
 account_id    | integer                     |           | not null |         | plain    |              |
 geo_partition | character varying           |           |          |         | extended |              |
 account_type  | character varying           |           | not null |         | extended |              |
 amount        | numeric                     |           | not null |         | main     |              |
 txn_type      | character varying           |           | not null |         | extended |              |
 created_at    | timestamp without time zone |           |          | now()   | plain    |              |
Partition key: LIST (geo_partition)
Partitions: bank_transactions_brazil FOR VALUES IN ('Brazil'),
            bank_transactions_eu FOR VALUES IN ('EU'),
            bank_transactions_india FOR VALUES IN ('India'),
            bank_transactions_us FOR VALUES IN ('US'),
            bank_transactions_default DEFAULT
</code></pre><p>As you can see we have a new partition for <code>DEFAULT</code></p></li><li><p>Now, lets try to insert a <code>Singapore</code> transaction again and see what happens.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql> <span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> bank_transactions
    <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>500</span>, <span style=color:#ae81ff>50001</span>, <span style=color:#e6db74>&#39;Singapore&#39;</span>, <span style=color:#e6db74>&#39;savings&#39;</span>, <span style=color:#ae81ff>2000</span>, <span style=color:#e6db74>&#39;credit&#39;</span>);
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>INSERT 0 1
</code></pre></li><li><p>Lets look at the whole table with the data locations</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> tableoid::regclass, <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> bank_transactions;
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>         tableoid          | user_id | account_id | geo_partition | account_type | amount | txn_type |         created_at
---------------------------+---------+------------+---------------+--------------+--------+----------+----------------------------
 bank_transactions_brazil  |     400 |      40001 | Brazil        | savings      |   1000 | credit   | 2022-03-17 23:18:48.225731
 bank_transactions_eu      |     200 |      10005 | EU            | checking     |    400 | credit   | 2022-03-17 22:52:33.346504
 bank_transactions_eu      |     100 |      10001 | EU            | checking     |  120.5 | debit    | 2022-03-17 20:36:05.603271
 bank_transactions_eu      |     100 |      10002 | EU            | checking     |    400 | debit    | 2022-03-17 22:43:37.235321
 bank_transactions_eu      |     100 |      10003 | EU            | checking     |    400 | credit   | 2022-03-17 22:43:37.235321
 bank_transactions_india   |     200 |      20001 | India         | savings      |   2000 | credit   | 2022-03-17 22:37:10.318521
 bank_transactions_us      |     100 |      10004 | US            | checking     |    400 | debit    | 2022-03-17 22:52:33.346504
 bank_transactions_us      |     300 |      30001 | US            | checking     | 105.25 | debit    | 2022-03-17 22:37:11.492779
 bank_transactions_default |     500 |      50001 | Singapore     | savings      |   2000 | credit   | 2022-03-17 23:26:28.548771
(9 rows)

</code></pre><p>So, record for <code>Singapore</code> is placed on the default partition.</p></li><li><p>(Optional) Open <a href=http://127.0.0.1:7000/tables>Master UI / Table List</a>, click <code>bank_transactions_default</code>. In the &ldquo;Replication Info&rdquo; you see following json:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#ae81ff>live_replicas {</span>
  <span style=color:#f92672>num_replicas</span>: <span style=color:#ae81ff>3</span>
  <span style=color:#ae81ff>placement_blocks {</span>
    <span style=color:#ae81ff>cloud_info {</span>
      <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
      <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;eu-central-1&#34;</span>
      <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;eu-central-1a&#34;</span>
    }
    <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
  }
  <span style=color:#ae81ff>placement_blocks {</span>
    <span style=color:#ae81ff>cloud_info {</span>
      <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
      <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;ap-south-1&#34;</span>
      <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;ap-south-1a&#34;</span>
    }
    <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
  }
  <span style=color:#ae81ff>placement_blocks {</span>
    <span style=color:#ae81ff>cloud_info {</span>
      <span style=color:#f92672>placement_cloud</span>: <span style=color:#e6db74>&#34;aws&#34;</span>
      <span style=color:#f92672>placement_region</span>: <span style=color:#e6db74>&#34;us-west-2&#34;</span>
      <span style=color:#f92672>placement_zone</span>: <span style=color:#e6db74>&#34;us-west-2a&#34;</span>
    }
    <span style=color:#f92672>min_num_replicas</span>: <span style=color:#ae81ff>1</span>
  }
}
</code></pre></div><p>This is same as the cluster level replication config, since we did not create any tablespace for the <code>bank_transactions_default</code> partition.</p></li></ol><h2 id=cleanup>Cleanup</h2><ol><li><p>Quit YSQL Shell</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>\</span>q
</code></pre></div></li><li><p>Destroy cluster</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>yb-ctl destroy --data_dir $PWD/data
</code></pre></div><p><strong>Output</strong></p><pre><code class=language-log data-lang=log>Destroying cluster.
</code></pre></li></ol><h2 id=want-to-learn-more>Want to Learn More?</h2><ol><li>Join DSS Asia on March 30-31. Register today at <a href=https://asia.distributedsql.org/>asia.distributedsql.org</a></li><li>Join <a href=https://yugabyte.com/slack>YugabyteDB - Community Slack</a> <a href=https://communityinviter.com/apps/yugabyte-db/register>alt</a></li><li>Watch <a href=https://www.linkedin.com/company/yugabyte/events/>YFTT - YugabyteDB Friday Tech Talk</a></li><li>Get a free training and certification at <a href=https://university.yugabyte.com>Yugabyte University</a></li><li>Sign Up for Free <a href=https://cloud.yugabyte.com>Yugabyte Cloud</a> account</li></ol><p><em>Original Source: <a href=https://docs.yugabyte.com/latest/explore/multi-region-deployments/row-level-geo-partitioning/>YB Docs for Row Level Geo Partitioning</a></em></p></div><div class=post_comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"yogendrarampuria"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article><aside class=sidebar><section class=sidebar_inner><div class=author_header><img src=https://yogendra.github.io/images/authors/yogi.jpg alt="Yogi photo"><h2>Yogi</h2></div><div class=author_bio>Software Engineer | OSS Advocate, User, Buyer and Seller</div><a href=https://yogendra.github.io/about/ class="button mt-1" role=button title="Read More">Read More</a><h2 class=mt-4>Recent Posts</h2><ul class=flex-column><li><a href=https://yogendra.github.io/2022/02/17/idd-dialer-v2/ class=nav-link title="IDD Dialer V2">IDD Dialer V2</a></li><li><a href=https://yogendra.github.io/2022/01/20/sudo-with-touch-id/ class=nav-link title="Sudo With Touch ID">Sudo With Touch ID</a></li><li><a href=https://yogendra.github.io/2021/09/07/migration-guide/ class=nav-link title="Migration Guide">Migration Guide</a></li><li><a href=https://yogendra.github.io/2019/03/15/right-abstraction/ class=nav-link title="Right Abstraction">Right Abstraction</a></li><li><a href=https://yogendra.github.io/2018/04/14/idd-dialer-my-first-app/ class=nav-link title="IDD Dialer - My First App">IDD Dialer - My First App</a></li><li><a href=https://yogendra.github.io/2018/01/26/mobile-sites-certification/ class=nav-link title="Mobile Sites Certification">Mobile Sites Certification</a></li><li><a href=https://yogendra.github.io/2017/10/28/puppeteer-no-strings-attached/ class=nav-link title="Puppeteer - No Strings Attached">Puppeteer - No Strings Attached</a></li><li><a href=https://yogendra.github.io/2017/09/19/kotlin-baby-steps/ class=nav-link title="Kotlin - Baby Steps">Kotlin - Baby Steps</a></li></ul><div><h2 class="mt-4 taxonomy" id=categories-section>Categories</h2><nav class=tags_nav><a href=https://yogendra.github.io/categories/technology/ class="post_tag button button_translucent" title=technology>TECHNOLOGY
<span class=button_tally>13</span></a>
<a href=https://yogendra.github.io/categories/inspirational/ class="post_tag button button_translucent" title=inspirational>INSPIRATIONAL
<span class=button_tally>9</span></a>
<a href=https://yogendra.github.io/categories/personal/ class="post_tag button button_translucent" title=personal>PERSONAL
<span class=button_tally>9</span></a>
<a href=https://yogendra.github.io/categories/programming/ class="post_tag button button_translucent" title=programming>PROGRAMMING
<span class=button_tally>5</span></a>
<a href=https://yogendra.github.io/categories/project/ class="post_tag button button_translucent" title=project>PROJECT
<span class=button_tally>5</span></a>
<a href=https://yogendra.github.io/categories/productivity/ class="post_tag button button_translucent" title=productivity>PRODUCTIVITY
<span class=button_tally>3</span></a>
<a href=https://yogendra.github.io/categories/announcement/ class="post_tag button button_translucent" title=announcement>ANNOUNCEMENT
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/categories/devops/ class="post_tag button button_translucent" title=devops>DEVOPS
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/categories/jokes/ class="post_tag button button_translucent" title=jokes>JOKES
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/categories/philanthrophy/ class="post_tag button button_translucent" title=philanthrophy>PHILANTHROPHY
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/categories/talk/ class="post_tag button button_translucent" title=talk>TALK
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/categories/tutorial/ class="post_tag button button_translucent" title=tutorial>TUTORIAL
<span class=button_tally>1</span></a></nav></div><div><h2 class="mt-4 taxonomy" id=tags-section>Tags</h2><nav class=tags_nav><a href=https://yogendra.github.io/tags/greeting/ class="post_tag button button_translucent" title=greeting>GREETING
<span class=button_tally>6</span></a>
<a href=https://yogendra.github.io/tags/%E0%A4%B9%E0%A4%BF%E0%A4%82%E0%A4%A6%E0%A5%80/ class="post_tag button button_translucent" title=हिंदी>हिंदी
<span class=button_tally>5</span></a>
<a href=https://yogendra.github.io/tags/android/ class="post_tag button button_translucent" title=android>ANDROID
<span class=button_tally>2</span></a>
<a href=https://yogendra.github.io/tags/java/ class="post_tag button button_translucent" title=java>JAVA
<span class=button_tally>2</span></a>
<a href=https://yogendra.github.io/tags/vagrant/ class="post_tag button button_translucent" title=vagrant>VAGRANT
<span class=button_tally>2</span></a>
<a href=https://yogendra.github.io/tags/web/ class="post_tag button button_translucent" title=web>WEB
<span class=button_tally>2</span></a>
<a href=https://yogendra.github.io/tags/app/ class="post_tag button button_translucent" title=app>APP
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/appengine/ class="post_tag button button_translucent" title=appengine>APPENGINE
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/blog/ class="post_tag button button_translucent" title=blog>BLOG
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/blogging/ class="post_tag button button_translucent" title=blogging>BLOGGING
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/bookmarklet/ class="post_tag button button_translucent" title=bookmarklet>BOOKMARKLET
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/books/ class="post_tag button button_translucent" title=books>BOOKS
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/caas/ class="post_tag button button_translucent" title=caas>CAAS
<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/cambodia/ class="post_tag button button_translucent" title=cambodia>CAMBODIA
<span class=button_tally>1</span></a><br><div class="post_tags_toggle button">All Tags</div><div class=post_tags><div class=tags_list><a href=https://yogendra.github.io/tags/android/ class="post_tag button button_translucent" data-position=2 title=android>ANDROID<span class=button_tally>2</span></a>
<a href=https://yogendra.github.io/tags/app/ class="post_tag button button_translucent" data-position=1 title=app>APP<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/appengine/ class="post_tag button button_translucent" data-position=1 title=appengine>APPENGINE<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/blog/ class="post_tag button button_translucent" data-position=1 title=blog>BLOG<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/blogging/ class="post_tag button button_translucent" data-position=1 title=blogging>BLOGGING<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/bookmarklet/ class="post_tag button button_translucent" data-position=1 title=bookmarklet>BOOKMARKLET<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/books/ class="post_tag button button_translucent" data-position=1 title=books>BOOKS<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/caas/ class="post_tag button button_translucent" data-position=1 title=caas>CAAS<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/cambodia/ class="post_tag button button_translucent" data-position=1 title=cambodia>CAMBODIA<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/cd/ci/ class="post_tag button button_translucent" data-position=1 title=cd/ci>CD/CI<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/celebration/ class="post_tag button button_translucent" data-position=1 title=celebration>CELEBRATION<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/cf/ class="post_tag button button_translucent" data-position=1 title=cf>CF<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/chrome/ class="post_tag button button_translucent" data-position=1 title=chrome>CHROME<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/cloud/ class="post_tag button button_translucent" data-position=1 title=cloud>CLOUD<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/cloud-native/ class="post_tag button button_translucent" data-position=1 title=cloud-native>CLOUD-NATIVE<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/containers/ class="post_tag button button_translucent" data-position=1 title=containers>CONTAINERS<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/data-strucrures/ class="post_tag button button_translucent" data-position=1 title=data-strucrures>DATA-STRUCRURES<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/development/ class="post_tag button button_translucent" data-position=1 title=development>DEVELOPMENT<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/devops/ class="post_tag button button_translucent" data-position=1 title=devops>DEVOPS<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/docker/ class="post_tag button button_translucent" data-position=1 title=docker>DOCKER<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/firefox/ class="post_tag button button_translucent" data-position=1 title=firefox>FIREFOX<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/fix/ class="post_tag button button_translucent" data-position=1 title=fix>FIX<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/fixme/ class="post_tag button button_translucent" data-position=1 title=fixme>FIXME<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/gdg/ class="post_tag button button_translucent" data-position=1 title=gdg>GDG<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/git/ class="post_tag button button_translucent" data-position=1 title=git>GIT<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/greeting/ class="post_tag button button_translucent" data-position=6 title=greeting>GREETING<span class=button_tally>6</span></a>
<a href=https://yogendra.github.io/tags/india/ class="post_tag button button_translucent" data-position=1 title=india>INDIA<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/java/ class="post_tag button button_translucent" data-position=2 title=java>JAVA<span class=button_tally>2</span></a>
<a href=https://yogendra.github.io/tags/javascript/ class="post_tag button button_translucent" data-position=1 title=javascript>JAVASCRIPT<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/kotlin/ class="post_tag button button_translucent" data-position=1 title=kotlin>KOTLIN<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/linux/ class="post_tag button button_translucent" data-position=1 title=linux>LINUX<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/lion/ class="post_tag button button_translucent" data-position=1 title=lion>LION<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/mac/ class="post_tag button button_translucent" data-position=1 title=mac>MAC<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/maven/ class="post_tag button button_translucent" data-position=1 title=maven>MAVEN<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/mobile/ class="post_tag button button_translucent" data-position=1 title=mobile>MOBILE<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/openvpn/ class="post_tag button button_translucent" data-position=1 title=openvpn>OPENVPN<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/opera/ class="post_tag button button_translucent" data-position=1 title=opera>OPERA<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/paas/ class="post_tag button button_translucent" data-position=1 title=paas>PAAS<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/parenting/ class="post_tag button button_translucent" data-position=1 title=parenting>PARENTING<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/pas/ class="post_tag button button_translucent" data-position=1 title=pas>PAS<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/pcf/ class="post_tag button button_translucent" data-position=1 title=pcf>PCF<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/poem/ class="post_tag button button_translucent" data-position=1 title=poem>POEM<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/remote/ class="post_tag button button_translucent" data-position=1 title=remote>REMOTE<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/s2/ class="post_tag button button_translucent" data-position=1 title=s2>S2<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/safari/ class="post_tag button button_translucent" data-position=1 title=safari>SAFARI<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/self-help/ class="post_tag button button_translucent" data-position=1 title=self-help>SELF-HELP<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/sgs2/ class="post_tag button button_translucent" data-position=1 title=sgs2>SGS2<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/shell/ class="post_tag button button_translucent" data-position=1 title=shell>SHELL<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/spring/ class="post_tag button button_translucent" data-position=1 title=spring>SPRING<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/spring-data-cloud-flow/ class="post_tag button button_translucent" data-position=1 title=spring-data-cloud-flow>SPRING-DATA-CLOUD-FLOW<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/story/ class="post_tag button button_translucent" data-position=1 title=story>STORY<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/technology/ class="post_tag button button_translucent" data-position=1 title=technology>TECHNOLOGY<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/testing/ class="post_tag button button_translucent" data-position=1 title=testing>TESTING<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/training/ class="post_tag button button_translucent" data-position=1 title=training>TRAINING<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/travel/ class="post_tag button button_translucent" data-position=1 title=travel>TRAVEL<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/tun.ko/ class="post_tag button button_translucent" data-position=1 title=tun.ko>TUN.KO<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/uob/ class="post_tag button button_translucent" data-position=1 title=uob>UOB<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/vagrant/ class="post_tag button button_translucent" data-position=2 title=vagrant>VAGRANT<span class=button_tally>2</span></a>
<a href=https://yogendra.github.io/tags/vm/ class="post_tag button button_translucent" data-position=1 title=vm>VM<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/vmware/ class="post_tag button button_translucent" data-position=1 title=vmware>VMWARE<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/vpn/ class="post_tag button button_translucent" data-position=1 title=vpn>VPN<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/web/ class="post_tag button button_translucent" data-position=2 title=web>WEB<span class=button_tally>2</span></a>
<a href=https://yogendra.github.io/tags/windows/ class="post_tag button button_translucent" data-position=1 title=windows>WINDOWS<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/yugabyte/ class="post_tag button button_translucent" data-position=1 title=yugabyte>YUGABYTE<span class=button_tally>1</span></a>
<a href=https://yogendra.github.io/tags/%E0%A4%B9%E0%A4%BF%E0%A4%82%E0%A4%A6%E0%A5%80/ class="post_tag button button_translucent" data-position=5 title=हिंदी>हिंदी<span class=button_tally>5</span></a><div class=tags_sort><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span></div><span class=tags_hide><svg class="icon"><use xlink:href="#closeme"/></svg></span></div></div></nav></div></section></aside></div></main><svg width="0" height="0" class="hidden"><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter"><path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68.0 01-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043.0-1.924.366-2.643 1.078a3.56 3.56.0 00-1.076 2.605c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846.0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47.0.929.273 1.705.82 2.388a3.623 3.623.0 002.115 1.291c-.312.08-.641.118-.979.118-.312.0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652.0 002.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422.0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139.0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77.0 001.172-4.892v-.468a7.788 7.788.0 001.84-1.921 8.142 8.142.0 01-2.11.593z"/></symbol><symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V4e2c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5.0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar"><path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916.0 1e2v352c0 33.084 26.916 60 60 60h392c33.084.0 60-26.916 60-60V1e2c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028.0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028.0 20 8.972 20 20v48z"/><path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github"><path d="M255.968 5.329C114.624 5.329.0 120.401.0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384.0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008.0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992.0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584.0 34.368-.32 62.08-.32 70.496.0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab"><path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6.0L12.3 74.8z"/><path d="M12.3 74.7.5 111c-1 3.2.0 6.8 3 8.8l101.6 74-92.5-119z"/><path d="M105 193.7l-38.6-119h-54l92.7 119z"/><path d="M105 193.7l38.7-119H66.4l38.7 119z"/><path d="M105 193.7l38.7-119H198l-93 119z"/><path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/><path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6.0L198 74.8z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss"><circle cx="3.429" cy="20.571" r="3.429"/><path d="M11.429 24h4.57C15.999 15.179 8.821 8.001.0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"/><path d="M24 24C24 10.766 13.234.0.0.0v4.571c10.714.0 19.43 8.714 19.43 19.429z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h362c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="arrow"><path d="M604.501 440.509 325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298.0 36.323s26.223 10.024 36.222.0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221.0 9.999-10.023 9.999-26.298.0-36.323z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly"><path d="M504.971 239.029 448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c19.851.0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002.0 004e2 320v108c0 19.851-16.149 36-36 36h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c46.318.0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568.0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255.0 24-10.745 24-24S205.255.0 192 0h-44c-46.318.0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568.0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255.0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851.0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002.0 00112 192z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy"><path d="M23 2.75A2.75 2.75.0 0020.25.0H8.75A2.75 2.75.0 006 2.75v13.5A2.75 2.75.0 008.75 19h11.5A2.75 2.75.0 0023 16.25zM18.25 14.5h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5z"/><path d="M8.75 20.5A4.255 4.255.0 014.5 16.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752.0 001 5.25v16A2.752 2.752.0 003.75 24h12a2.752 2.752.0 002.75-2.75v-.75z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme"><path d="M284.286 256.002 506.143 34.144c7.811-7.811 7.811-20.475.0-28.285-7.811-7.81-20.475-7.811-28.285.0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285.0-7.81 7.811-7.811 20.475.0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475.0 28.285a19.938 19.938.0 0014.143 5.857 19.94 19.94.0 0014.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475.0-28.285L284.286 256.002z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu"><path d="M492 236H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954.0 96s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram"><path d="M12 2.163c3.204.0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849.0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204.0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849.0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741.0 8.333.014 7.053.072c-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.668.072 4.948c.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24s3.668-.014 4.948-.072c4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403.0-6.162 2.759-6.162 6.162S8.597 18.163 12 18.163s6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zM12 16c-2.209.0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796.0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795.0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="youtube"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23.0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23.0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816V8l8 3.993L9 16z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow"><path d="M21 27v-8h3v11H0V19h3v8h18z"/><path d="M17.1.2 15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8 13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="xing"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></symbol></svg><footer class=footer><div class="footer_inner wrap pale"><img src=https://yogendra.github.io/icons/apple-touch-icon.png class="icon icon_2 transparent" alt="Yogendra Rampuria"><p>Copyright&nbsp;2012-&nbsp;<span class=year></span>&nbsp;YOGENDRA RAMPURIA. All Rights Reserved</p><a class=to_top href=#documentTop><svg class="icon"><use xlink:href="#arrow"/></svg></a></div></footer><script type=text/javascript src=https://yogendra.github.io/js/bundle.min.da0313a21911386c83a3ac1292945219a043acb97b47a4a9f491890f81a8a94381d0a21a63ae910c05135033e52cac73a1bd5be668d695235a5361f238d4ccb0.js integrity="sha512-2gMTohkROGyDo6wSkpRSGaBDrLl7R6Sp9JGJD4GoqUOB0KIaY66RDAUTUDPlLKxzob1b5mjWlSNaU2HyONTMsA==" crossorigin=anonymous></script></body></html>