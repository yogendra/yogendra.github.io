<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>cd/ci on Yogendra Rampuria</title><link>https://yogendra.github.io/tags/cd/ci/</link><description>Recent content in cd/ci on Yogendra Rampuria</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Copyright © 2012–2021, Yogendra Rampuria; all rights reserved.</copyright><atom:link href="https://yogendra.github.io/tags/cd/ci/index.xml" rel="self" type="application/rss+xml"/><item><title>Migration Mania</title><link>https://yogendra.github.io/2017/07/20/migration-mania/</link><pubDate>Thu, 20 Jul 2017 22:13:49 +0000</pubDate><guid>https://yogendra.github.io/2017/07/20/migration-mania/</guid><description>
&lt;p>I am embarking on this new journey to use &lt;a href="https://www.staticgen.com/">Static Site Generator&lt;/a>.&lt;/p>
&lt;p>&lt;img src="migration-mania/html-js-css.png" alt="type-icon-right">&lt;/p>
&lt;p>So far, I have managed to setup:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://gohugo.io">Hugo&lt;/a> base project&lt;/li>
&lt;li>&lt;a href="https://www.github.com/yogendra/yogendra.me">GitHub repository&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://travis-ci.org/yogendra/yogendra.me">Travis CI&lt;/a> based build and deploy&lt;/li>
&lt;/ul>
&lt;p>I have a shared hosting service (for many years now) so I want to use that to host my site. This added some (small) challenges in my journey. I will share my experience, so far and in future, in this post. One thing that I really like is how natural I find this. After all I am a &lt;em>Programmer&lt;/em>.&lt;/p>
&lt;h2 id="how-can-you-use-my-work">How can you use my work?&lt;/h2>
&lt;p>You can fork my repository (link above) and follow the simple instruction on the &lt;code>README.md&lt;/code> to start using. I will use my own repository for instructions here.&lt;/p>
&lt;p>Before you start, get these softwares and setup correctly&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://gohugo.io/getting-started/installing/">Hugo&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">Git&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/travis-ci/travis.rb#installation">Travis CI Client&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://firebase.google.com/docs/cli/">Firebase CLI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/kennethreitz/autoenv">autoenv&lt;/a> &lt;em>(Optional but Highly Recommended)&lt;/em>&lt;/li>
&lt;/ul>
&lt;p>I use &lt;a href="https://github.com/kennethreitz/autoenv">autoenv&lt;/a> to manager per-project shell environment. It executes &lt;code>.env&lt;/code> file in the directory when you &lt;code>cd&lt;/code> into it. This is optional but very useful.&lt;/p>
&lt;h2 id="clone-and-change">Clone and Change&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">git clone git@github.com:yogendra/yogendra.me.git
cd yogendra.me
git submodule update --init --recursive
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here are some changes that you should consider:&lt;/p>
&lt;ul>
&lt;li>You should probably delete &lt;code>site/content/*&lt;/code> and &lt;code>site/static/*&lt;/code> (or not).&lt;/li>
&lt;li>You &lt;strong>should&lt;/strong> change information in &lt;code>config.toml&lt;/code>, consider changing:
&lt;ul>
&lt;li>googleAnalytics&lt;/li>
&lt;li>baseUrl&lt;/li>
&lt;li>title&lt;/li>
&lt;li>author&lt;/li>
&lt;li>description&lt;/li>
&lt;li>githubUsername&lt;/li>
&lt;li>[menu.icon] links&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="run-and-test">Run and Test&lt;/h2>
&lt;p>You can run development server using following command&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">hugo server -s site -wDEF -b http://localhost:1313 --navigateToChanged --cleanDestinationDir -d dev
&lt;/code>&lt;/pre>&lt;/div>&lt;p>What the hell! Read instruction in &lt;code>hugo server --help&lt;/code> to understand what each of those switches mean. We are asking hugo to:&lt;/p>
&lt;ul>
&lt;li>-w : watch for changes&lt;/li>
&lt;li>-D : build draft&lt;/li>
&lt;li>-E : build expired pages&lt;/li>
&lt;li>-F : build future date page,&lt;/li>
&lt;li>-b : set base url to &lt;code>http://localhost:1313&lt;/code>&lt;/li>
&lt;li>&amp;ndash;navigateToChanged : navigate browser to updated file&lt;/li>
&lt;li>&amp;ndash;cleanDestinationDir: Delete all the files that might be there in destination dir&lt;/li>
&lt;li>-d : Destination dir to store files into&lt;/li>
&lt;/ul>
&lt;p>You can add your own content using command like&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">cd site
hugo new post/&amp;lt;post-name.md&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>When you want to prepare actual deployment, you can use following command&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">hugo -s site -d public
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="configure-firebase">Configure Firebase&lt;/h2>
&lt;p>I recommend using &lt;a href="https://firebase.google.com">Firebase&lt;/a>. Read the &lt;a href="https://firebase.google.com/docs/hosting/">hosting guide&lt;/a> and get familiar with the concept and commands.&lt;/p>
&lt;p>First, login to firebase from cli. This needs to be done only once. If you have already done this for any other prohect, you can skip this step&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">$ firebase login
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now you need to initialize firebase setting for the project. This will run as a wizard. Follow onscreen instructions.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">$ firebase init hosting
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You may test your firebase configuration by deploying changes directly from your machine&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">$ firebase deploy
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>Important:&lt;/strong> &lt;em>Choose &amp;ldquo;N&amp;rdquo; for &amp;ldquo;Configure as a single-page app (rewrite all urls to /index.html)?&amp;rdquo;. Also, don&amp;rsquo;t overwrite files under &lt;code>public/&lt;/code>&lt;/em>&lt;/p>
&lt;h2 id="configure-travis-ci">Configure Travis CI&lt;/h2>
&lt;p>&lt;em>Based on &lt;a href="https://docs.travis-ci.com/user/deployment/firebase/">Travis CI - Firebase Deployment&lt;/a>&lt;/em>&lt;/p>
&lt;p>Create a new project on Travis CI website website. Login to Travis CI via &lt;code>travis&lt;/code> command.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">$ travis login
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Get a deployment token from firebase, for using in travis ci build environment.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">$ firebase login:ci
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This should generate a string that looks like &lt;code>1/AD7sdasdasdKJA824OvEFc1c89Xz2ilBlaBlaBla&lt;/code>.
Use following command to encrypt this string and use in &lt;code>.travis.yml&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">$ travis encrypt &lt;span style="color:#e6db74">&amp;#34;1/AD7sdasdasdKJA824OvEFc1c89Xz2ilBlaBlaBla&amp;#34;&lt;/span> --add
SUPER-SECRET-ENCRYPTED-VALUE
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Replace &lt;code>deploy&lt;/code> key in &lt;code>.travis.yml&lt;/code> with folowing text. Remember to change &lt;code>SUPER-SECRET-ENCRYPTED-VALUE&lt;/code> with text from last command output&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#f92672">deploy&lt;/span>:
&lt;span style="color:#f92672">provider&lt;/span>: &lt;span style="color:#ae81ff">firebase&lt;/span>
&lt;span style="color:#f92672">token&lt;/span>:
&lt;span style="color:#f92672">secure&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;SUPER-SECRET-ENCRYPTED-VALUE&amp;#34;&lt;/span>
&lt;span style="color:#f92672">on&lt;/span>:
&lt;span style="color:#f92672">branch&lt;/span>: &lt;span style="color:#ae81ff">master&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>That&amp;rsquo;s it! Don&amp;rsquo;t forget to checkin your changes.&lt;/p></description></item></channel></rss>